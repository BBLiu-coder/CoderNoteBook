## 重构 改善既有代码的设计


## 目录

* [第一章 第一个重构的例子](#第一章)
* [第三章 坏代码的味道](#第三章-坏代码的味道)
* [第四章 构建测试体系](#第四章-构建测试体系)

---

## 第一章

第一章看到一个很有趣的一句话，就是当进行重构的时候，**为即将修改的代码建立一组可靠的测试环境。**

贴上一个看到的一组测试代码。

```
class CAL 
{
    public:
    int add(int val1,int val2)
    {
        return val1+val2;
    }
};

CAL cal;

namespace test_env
{
    void test_case1()
    {
        int val1= 100;
        int val2 = 200;
        assert(cal.add(val1,val2) == val1+val2);
    }

    void test_case2()
    {
        int val1= -20000;
        int val2 = -10000;
        assert(cal.add(val1,val2) == val1+val2);
    }

    void run_case()
    {
        test_case1();
        test_case2();
        cout<<"pass case"<<endl;
    }
}

int main()
{
    test_env::run_case();

    return 0;
}
```


## 第三章-坏代码的味道

书里面讲了很多道理，我比较有体会的几个道理。

* 重复代码

* 过长的函数

    一个函数的代码过于多，这个表示函数里面想做的事情太多了。**违背单一职责的原则**。 

* 过大的类

* 过长的参数列表

* 少用switch-case

## 第四章-构建测试体系 

* 写测试的价值
    
    这一张其实讲了一个很好的点，就是面向测试去写代码。在开发的时候，花一点时间去写一份test-case，这样，反而在后面的增量开发的时候，这样应该可以更加提高效率。